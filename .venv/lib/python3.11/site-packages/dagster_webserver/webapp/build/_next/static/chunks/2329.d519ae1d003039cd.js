"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2329],{60648:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(52322),s=n(43212),o=n(14934),i=n(55010),l=n(2784),a=n(90797),d=n(88257),c=n(54516),u=n(84046),p=n(59351),x=n(33182),h=n(88610);let m=(0,l.memo)(e=>{let{name:t,run:n,showHover:m=!1,showButton:j=!0,showSummary:f=!0}=e,{status:g}=n,b=(0,l.useMemo)(()=>{switch(g){case d.VOA.SUCCESS:return"success";case d.VOA.CANCELED:case d.VOA.CANCELING:case d.VOA.FAILURE:return"danger";default:return"none"}},[g]);return(0,r.jsxs)(o.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-start",gap:16},children:[(0,r.jsxs)(o.x,{flex:{direction:"column",alignItems:"flex-start",gap:4},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[(()=>{let e=(0,r.jsx)(s.V,{intent:b,children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:4},children:[(0,r.jsx)(c.K9,{status:n.status,size:10}),(0,r.jsx)(x.Zr,{run:n})]})});return m?(0,r.jsx)(i.J,{position:"top",interactionKind:"hover",content:(0,r.jsx)("div",{children:(0,r.jsx)(u.qL,{run:n,name:t})}),hoverOpenDelay:100,children:e}):e})(),f?(0,r.jsx)(x.Tw,{run:n}):null]}),f&&(p.hd.has(n.status)||p.Ys.has(n.status))?(0,r.jsx)(a.I,{runId:n.id}):void 0]}),j?(0,r.jsx)(h.A,{to:`/runs/${n.id}`,children:"View run"}):null]})})},90797:function(e,t,n){n.d(t,{I:function(){return x}});var r=n(52322),s=n(35292),o=n(39013),i=n(19126),l=n.n(i),a=n(2784),d=n(47933),c=n(20958),u=n(88257),p=n(59351);let x=e=>{let{runId:t}=e,{data:n}=(0,c.aM)(h,{variables:{runId:t}}),i=n?.pipelineRunOrError,x=i?.__typename==="Run"?i.status:null,m=(0,a.useMemo)(()=>{if(i?.__typename!=="Run")return[];let{status:e}=i;return p.hd.has(e)?i.stepStats.filter(e=>e.status===u.SGm.FAILURE):p.Ys.has(e)?i.stepStats.filter(e=>e.status===u.SGm.IN_PROGRESS):[]},[i]),j=m.length;if(!j||!x)return null;if(p.hd.has(x)){if(1===j){let e=m[0],n=e.endTime?l().stringify({focusedTime:Math.floor(1e3*e.endTime)},{addQueryPrefix:!0}):"";return(0,r.jsxs)(s.YS,{color:o.$(),children:["Failed at ",(0,r.jsx)(d.rU,{to:`/runs/${t}${n}`,children:e.stepKey})]})}return(0,r.jsxs)(s.YS,{color:o.$(),children:["Failed at ",(0,r.jsxs)(d.rU,{to:`/runs/${t}`,children:[j," steps"]})]})}if(p.Ys.has(x)){if(1===j){let e=m[0],n=e.endTime?l().stringify({focusedTime:Math.floor(1e3*e.endTime)},{addQueryPrefix:!0}):"";return(0,r.jsxs)(s.YS,{color:o.$(),children:["In progress at ",(0,r.jsx)(d.rU,{to:`/runs/${t}${n}`,children:e.stepKey})]})}return(0,r.jsxs)(s.YS,{color:o.$(),children:["In progress at ",(0,r.jsxs)(d.rU,{to:`/runs/${t}`,children:[j," steps"]})]})}return null},h=(0,c.Ps)`
  query StepSummaryForRunQuery($runId: ID!) {
    pipelineRunOrError(runId: $runId) {
      ... on Run {
        id
        status
        stepStats {
          endTime
          stepKey
          status
        }
      }
    }
  }
`},72329:function(e,t,n){n.r(t),n.d(t,{JobsRoot:function(){return ef},default:function(){return eg}});var r=n(52322),s=n(14934),o=n(74580),i=n(35292),l=n(36853),a=n(79106),d=n(39013),c=n(37483),u=n(45774),p=n(2784),x=n(44900),h=n(4378);let m=e=>{let[t,n]=(0,h.q)({encode:t=>e.reduce((e,n)=>{let r=t[n];return e[n]=r?.length?JSON.stringify(r):void 0,e},{}),decode:t=>e.reduce((e,n)=>(e[n]=t[n]?JSON.parse(t[n]):[],e),{})}),r=(0,p.useMemo)(()=>{let t={};return e.forEach(e=>{t[`set${e.charAt(0).toUpperCase()+e.slice(1)}`]=t=>{n(n=>({...n,[e]:t instanceof Function?t(n[e]):t}))}}),t},[e,n]);return{state:t,setState:n,setters:r}};var j=n(90483),f=n(35002),g=n(43212),b=n(88510),y=n(22921),w=n(17008),v=n(98956),I=n(50646),S=n(58495),C=n(53664),E=n(47933),L=n(2728),$=n(83738),N=n(92199),R=n(10539),A=n(20958),J=n(16336),P=n(60603),O=n(55010),U=n(38491),M=n(36803),k=n(48764),T=n(51701),_=n(88257),q=n(83846),z=n(42519),F=n(43);let V=e=>{let{job:t,isAssetJob:n,repoAddress:s}=e,o=t.runs.length?t.runs[0]:null,i={pipelineName:t.name,repositoryName:s.name,repositoryLocationName:s.location},d=(0,k.DO)(t.name),c=(0,z.D)(),{permissions:{canLaunchPipelineReexecution:u,canLaunchPipelineExecution:x},disabledReasons:h}=(0,M.xz)(s.location),[m,j]=(0,A.td)(Z),{data:g}=j,b=(0,p.useCallback)(()=>{o?.id&&m({variables:{runId:o.id}})},[o,m]),y=g?.pipelineRunOrError.__typename==="Run"?g?.pipelineRunOrError:null,w="loading"===n?(0,r.jsx)(P.sN,{icon:"execute",text:"Loading...",disabled:!0}):!0===n?(0,r.jsx)(P.sN,{icon:d.loading?(0,r.jsx)(a.$,{purpose:"caption-text"}):"execute",text:"Launch new run",disabled:!x,onClick:e=>d.onClick(i,e)}):(0,r.jsx)(F.U,{icon:"execute",text:"Launch new run",disabled:!x,to:(0,R.jT)({repoName:s.name,repoLocation:s.location,pipelineName:t.name,isJob:t.isJob,path:"/playground"})}),v=(0,r.jsx)(P.sN,{icon:"replay",text:"Re-execute latest run",onClick:()=>y?c(y,_.hmq.ALL_STEPS):void 0,disabled:!u||!y||!(0,q.EP)(y)}),I=(0,r.jsx)(P.sN,{icon:"sync_problem",text:"Re-execute latest run from failure",onClick:()=>y?c(y,_.hmq.FROM_FAILURE):void 0,disabled:!u||!y||!(0,q.VM)(y)});return(0,r.jsxs)(r.Fragment,{children:[d.launchpadElement,(0,r.jsx)(O.J,{onOpened:()=>b(),content:(0,r.jsxs)(P.v2,{children:[(0,r.jsx)(F.U,{to:(0,R.jT)({repoName:s.name,repoLocation:s.location,pipelineName:t.name,isJob:t.isJob}),icon:"job",text:"View job"}),(0,r.jsx)(F.U,{to:(0,R.jT)({repoName:s.name,repoLocation:s.location,pipelineName:t.name,isJob:t.isJob,path:"/runs"}),icon:"checklist",text:"View all recent runs"}),x?w:(0,r.jsx)(f.u,{content:h.canLaunchPipelineExecution,display:"block",children:w}),u?v:(0,r.jsx)(f.u,{content:h.canLaunchPipelineReexecution,display:"block",children:v}),u?I:(0,r.jsx)(f.u,{content:h.canLaunchPipelineReexecution,display:"block",children:I})]}),position:"bottom-left",children:(0,r.jsx)(U.zx,{icon:(0,r.jsx)(l.JO,{name:"expand_more"})})})]})},Z=(0,A.Ps)`
  query RunReExecutionQuery($runId: ID!) {
    pipelineRunOrError(runId: $runId) {
      ... on Run {
        id
        status
        pipelineName
        executionPlan {
          artifactsPersisted
          ...ExecutionPlanToGraphFragment
        }
      }
    }
  }
  ${T.$}
`;var Y=n(60648),Q=n(74283),D=n(84046),G=n(33182),K=n(4219),H=n(60918);let W="1.5fr 1fr 180px 96px 80px",X=e=>{let{name:t,isJob:n,repoAddress:o,start:i,height:l}=e,a=(0,S.F)(100),d=(0,A.aM)(en,{variables:{selector:(0,N._T)(o,t)},skip:!a});(0,J.C4)(d,J.dT);let{data:c}=d,u=c?.pipelineOrError.__typename==="Pipeline"?c?.pipelineOrError:void 0,{schedules:x,sensors:h}=(0,p.useMemo)(()=>{if(u){let{schedules:e,sensors:t}=u;return{schedules:e,sensors:t}}return{schedules:[],sensors:[]}},[u]),m=(0,p.useMemo)(()=>{if(u){let{runs:e}=u;if(e.length)return[...e]}return[]},[u]);return(0,r.jsx)(w.X2,{$height:l,$start:i,children:(0,r.jsxs)(ee,{border:"bottom",children:[(0,r.jsxs)(w.E5,{children:[(0,r.jsx)("div",{style:{maxWidth:"100%",whiteSpace:"nowrap",fontWeight:500},children:(0,r.jsx)(E.rU,{to:(0,R.$U)(o,`/jobs/${t}`),children:(0,r.jsx)(C.g,{text:t})})}),(0,r.jsx)($.HB,{children:u?.description||""})]}),(0,r.jsx)(w.E5,{children:x.length||h.length?(0,r.jsx)(s.x,{flex:{direction:"column",alignItems:"flex-start",gap:8},children:(0,r.jsx)(et,{children:(0,r.jsx)(Q.I,{schedules:x,sensors:h,repoAddress:o})})}):(0,r.jsx)($.mq,{queryResult:d})}),(0,r.jsx)(w.E5,{children:m[0]?(0,r.jsx)(Y.Z,{run:m[0],showButton:!1,showHover:!0,showSummary:!1,name:t}):(0,r.jsx)($.mq,{queryResult:d})}),(0,r.jsx)(w.E5,{children:m.length?(0,r.jsx)(s.x,{padding:{top:4},children:(0,r.jsx)(D.JH,{jobName:t,runs:[...m].reverse(),fade:!0})}):(0,r.jsx)($.mq,{queryResult:d})}),(0,r.jsx)(w.E5,{children:(0,r.jsx)(s.x,{flex:{justifyContent:"flex-end"},style:{marginTop:"-2px"},children:(0,r.jsx)(V,{job:{name:t,isJob:n,runs:m},isAssetJob:u?u.isAssetJob:"loading",repoAddress:o})})})]})})},B=()=>(0,r.jsxs)(w.VJ,{templateColumns:W,sticky:!0,children:[(0,r.jsx)(w.qN,{children:"Name"}),(0,r.jsx)(w.qN,{children:"Schedules/sensors"}),(0,r.jsx)(w.qN,{children:"Latest run"}),(0,r.jsx)(w.qN,{children:"Run history"}),(0,r.jsx)(w.qN,{})]}),ee=(0,L.ZP)(s.x).withConfig({componentId:"sc-6bbb92a3-0"})(["display:grid;grid-template-columns:",";height:100%;"],W),et=L.ZP.div.withConfig({componentId:"sc-6bbb92a3-1"})(["width:100%;> .bp5-popover-target{width:100%;}"]),en=(0,A.Ps)`
  query SingleJobQuery($selector: PipelineSelector!) {
    pipelineOrError(params: $selector) {
      ... on Pipeline {
        id
        name
        isJob
        isAssetJob
        description
        runs(limit: 5) {
          id
          ...RunTimeFragment
        }
        schedules {
          id
          ...ScheduleSwitchFragment
        }
        sensors {
          id
          ...SensorSwitchFragment
        }
      }
    }
  }

  ${G.$X}
  ${K.J}
  ${H.U}
`;var er=n(22563);let es=e=>{let{repos:t}=e,n=(0,p.useRef)(null),s=(0,p.useMemo)(()=>t.map(e=>{let{repoAddress:t}=e;return(0,er.Uz)(t)}),[t]),{expandedKeys:o,onToggle:i,onToggleAll:l}=(0,I.N)(y.y,s),a=(0,p.useMemo)(()=>{let e=[];return t.forEach(t=>{let{repoAddress:n,jobs:r}=t;e.push({type:"header",repoAddress:n,jobCount:r.length});let s=(0,er.Uz)(n);o.includes(s)&&r.forEach(t=>{let{isJob:r,name:s}=t;e.push({type:"job",repoAddress:n,isJob:r,name:s})})}),e},[t,o]),d=(0,v.w)(t.map(e=>{let{repoAddress:t}=e;return t.name})),c=(0,b.MG)({count:a.length,getScrollElement:()=>n.current,estimateSize:e=>{let t=a[e];return t?.type==="header"?w.lo:64},overscan:10}),u=c.getTotalSize(),x=c.getVirtualItems();return(0,r.jsx)("div",{style:{overflow:"hidden"},children:(0,r.jsxs)(w.W2,{ref:n,children:[(0,r.jsx)(B,{}),(0,r.jsx)(w.Nh,{$totalHeight:u,children:x.map(e=>{let{index:t,key:n,size:s,start:c}=e,u=a[t];return"header"===u.type?(0,r.jsx)($.vG,{repoAddress:u.repoAddress,height:s,start:c,onToggle:i,onToggleAll:l,expanded:o.includes((0,er.Uz)(u.repoAddress)),showLocation:d.has(u.repoAddress.name),rightElement:(0,r.jsx)(f.u,{content:1===u.jobCount?"1 job":`${u.jobCount} jobs`,placement:"top",children:(0,r.jsx)(g.V,{children:u.jobCount})})},n):(0,r.jsx)(X,{name:u.name,isJob:u.isJob,repoAddress:u.repoAddress,height:s,start:c},n)})})]})})};var eo=n(907),ei=n(49455),el=n(14648),ea=n(74548),ed=n(50027),ec=n(17867),eu=n(65822);let ep=["jobs","tags","codeLocations"],ex=()=>{let{allRepos:e,visibleRepos:t,loading:n,data:o}=(0,p.useContext)(ec.C5),i=e.length,x=(0,p.useMemo)(()=>{let e=Object.values(o).filter(e=>"WorkspaceLocationEntry"===e.__typename),n=(0,ei.S)(t);return eh(e).filter(e=>{let{repoAddress:t}=e;return n.has((0,er.Uz)(t))})},[o,t]),h=(0,p.useMemo)(()=>x.flatMap(e=>e.jobs),[x]),{state:f,setters:g}=m(ep),b=(0,p.useMemo)(()=>({...f,codeLocations:f.codeLocations.map(e=>{let{name:t,location:n}=e;return(0,eu.kQ)(t,n)})}),[f]),y=(0,ed.A)({codeLocations:b.codeLocations,setCodeLocations:g.setCodeLocations}),w=(0,ea.im)({name:"Job",icon:"job",allValues:(0,p.useMemo)(()=>h.map(e=>({key:e.name,value:e.name,match:[e.name]})),[h]),renderLabel:e=>{let{value:t}=e;return(0,r.jsxs)(s.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,r.jsx)(l.JO,{name:"job"}),(0,r.jsx)(j.rd,{text:t})]})},getStringValue:e=>e,state:b.jobs,onStateChanged:(0,p.useCallback)(e=>{g.setJobs(Array.from(e))},[g])}),v=(0,p.useMemo)(()=>[y,w],[y,w]),{button:I,activeFiltersJsx:S}=(0,el.m)({filters:v}),C=(0,p.useMemo)(()=>x.filter(e=>!b.codeLocations.length||b.codeLocations.includes(e.repoAddress)).map(e=>({...e,jobs:e.jobs.filter(e=>!b.jobs.length||!!b.jobs.includes(e.name))})).filter(e=>!!e.jobs.length),[x,b]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.x,{padding:{horizontal:24,vertical:8},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",grow:0},border:"bottom",children:I}),S.length?(0,r.jsx)(s.x,{padding:{vertical:8,horizontal:24},border:"bottom",flex:{direction:"row",gap:8},children:S}):null,n&&!i?(0,r.jsx)(s.x,{padding:64,children:(0,r.jsx)(u.f,{label:"Loading jobs…"})}):n?(0,r.jsx)(s.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,r.jsxs)(s.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,r.jsx)(a.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:d.$()},children:"Loading jobs…"})]})}):C.length?(0,r.jsx)(es,{repos:C}):(0,r.jsx)(s.x,{padding:{top:20},children:(0,r.jsx)(c.t,{icon:"search",title:"No jobs",description:x.length?"No jobs were found that match your filters":"No jobs were found in your definitions"})})]})},eh=e=>{let t=e.map(e=>e.locationOrLoadError),n=[];for(let e of t)if(e?.__typename==="RepositoryLocation")for(let t of e.repositories){let{name:r,pipelines:s}=t,o=(0,eu.kQ)(r,e.name),i=s.filter(e=>{let{name:t}=e;return!(0,x.pv)(t)});i.length>0&&n.push({repoAddress:o,jobs:i})}return(0,eo.S)(n)};var em=n(69737),ej=n(20171);let ef=()=>((0,em.Px)(),(0,ej.j)("Jobs"),(0,r.jsxs)(s.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(o.m,{title:(0,r.jsx)(i.X6,{children:"Jobs"})}),(0,r.jsx)(ex,{})]}));var eg=ef},907:function(e,t,n){n.d(t,{S:function(){return s}});var r=n(22563);let s=e=>[...e].sort((e,t)=>{let n=(0,r.Uz)(e.repoAddress),s=(0,r.Uz)(t.repoAddress);return n.localeCompare(s)})},49455:function(e,t,n){n.d(t,{S:function(){return o}});var r=n(65822),s=n(22563);let o=e=>new Set(e.map(e=>(0,s.Uz)((0,r.kQ)(e.repository.name,e.repositoryLocation.name))))},84046:function(e,t,n){n.d(t,{JH:function(){return f},qL:function(){return g}});var r=n(52322),s=n(14934),o=n(55010),i=n(35292),l=n(39013),a=n(74188),d=n(47933),c=n(2728),u=n(54516),p=n(67994),x=n(59351),h=n(33182),m=n(90797);let j=e=>{let{status:t,opacity:n=1}=e,s=p.YM[t];return(0,r.jsx)(I,{$color:s,$opacity:n})},f=e=>{let{fade:t,jobName:n,runs:i}=e,l=i.length,a=.8/Math.max(3,l);return(0,r.jsx)(s.x,{flex:{direction:"row",alignItems:"center",gap:2},children:i.map((e,s)=>(0,r.jsx)(o.J,{position:"top",interactionKind:"hover",content:(0,r.jsx)("div",{children:(0,r.jsx)(g,{run:e,name:n})}),hoverOpenDelay:100,children:(0,r.jsx)(j,{runId:e.id,status:e.status,opacity:t?1-(l-s-1)*a:1},e.id)},e.id))})},g=e=>{let{name:t,run:n}=e;return(0,r.jsxs)(b,{children:[(0,r.jsx)(y,{children:t}),(0,r.jsxs)(w,{children:[(0,r.jsxs)(s.x,{flex:{alignItems:"center",direction:"row",gap:8},children:[(0,r.jsx)(u.K9,{status:n.status}),(0,r.jsx)(d.rU,{to:`/runs/${n.id}`,children:(0,r.jsx)(i.aU,{children:(0,h.EI)(n)})})]}),(0,r.jsxs)(s.x,{flex:{direction:"column",gap:4},children:[(0,r.jsx)(h.Zr,{run:n}),(0,r.jsx)(h.Tw,{run:n})]})]}),x.hd.has(n.status)||x.Ys.has(n.status)?(0,r.jsx)(v,{children:(0,r.jsx)(m.I,{runId:n.id})}):null]})},b=c.ZP.div.withConfig({componentId:"sc-d6498aea-0"})(["padding:4px;font-size:12px;width:220px;"]),y=c.ZP.div.withConfig({componentId:"sc-d6498aea-1"})(["padding:8px;box-shadow:inset 0 -1px ",";font-family:",";font-size:14px;font-weight:500;color:",";max-width:100%;text-overflow:ellipsis;overflow:hidden;min-width:0px;"],l.wL(),a.b.default,l.Ep()),w=c.ZP.div.withConfig({componentId:"sc-d6498aea-2"})(["padding:8px;display:flex;align-items:flex-start;justify-content:space-between;"]),v=c.ZP.div.withConfig({componentId:"sc-d6498aea-3"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:4px 8px 8px;&:empty{display:none;}"]),I=c.ZP.div.withConfig({componentId:"sc-d6498aea-4"})(["background-color:",";border-radius:2px;height:16px;opacity:",";width:8px;"],e=>{let{$color:t}=e;return t},e=>{let{$opacity:t}=e;return t})}}]);
//# sourceMappingURL=2329.d519ae1d003039cd.js.map